<!DOCTYPE html>
<html>
<head>
    <title>Test Paper Fetching</title>
</head>
<body>
    <h1>Test Paper Fetching</h1>
    <button onclick="testFetch()">Test Fetch Papers</button>
    <div id="results"></div>

    <script>
        async function testFetch() {
            console.log('Testing fetch...');
            document.getElementById('results').innerHTML = 'Loading...';

            try {
                const response = await fetch('/api/fetch', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        keyword: 'serverless',
                        additional_keyword: 'performance',
                        from_year: 2020,
                        to_year: 2025,
                        total_results: 5
                    })
                });

                console.log('Response status:', response.status);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                console.log('Result:', result);

                if (result.success && result.papers) {
                    let html = `<h3>Found ${result.papers.length} papers:</h3>`;
                    result.papers.forEach((paper, index) => {
                        html += `
                            <div style="border: 1px solid #ccc; margin: 10px; padding: 10px;">
                                <h4>${index + 1}. ${paper.title}</h4>
                                <p><strong>Authors:</strong> ${paper.authors}</p>
                                <p><strong>Journal:</strong> ${paper.journal}</p>
                                <p><strong>Year:</strong> ${paper.year}</p>
                                <p><strong>DOI:</strong> ${paper.doi}</p>
                            </div>
                        `;
                    });
                    document.getElementById('results').innerHTML = html;
                } else {
                    document.getElementById('results').innerHTML = 'No papers found or API error';
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('results').innerHTML = 'Error: ' + error.message;
            }
        }
    </script>
</body>
</html>
